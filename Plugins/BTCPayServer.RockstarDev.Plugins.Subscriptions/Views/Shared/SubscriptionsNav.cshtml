@using BTCPayServer.Abstractions.Contracts
@using BTCPayServer.Abstractions.Extensions
@using BTCPayServer.Client
@using BTCPayServer.RockstarDev.Plugins.Subscriptions
@using Microsoft.AspNetCore.Mvc.TagHelpers
@inject IScopeProvider ScopeProvider
@{
    var storeId = ScopeProvider.GetCurrentStoreId();
    var activeClass = @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey);
    var isActive = !string.IsNullOrWhiteSpace(activeClass);
}
@if (!string.IsNullOrEmpty(storeId))
{
    <li class="nav-item">
        <a permission="@Policies.CanModifyServerSettings"
           asp-controller="Subscription" asp-action="Index" asp-route-storeId="@storeId"
           class="nav-link @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey, null, "Subscriptions")">

            <svg class="icon" role="img" viewBox="0 0 122.88 109.93">
                <defs>
                    <style>
                        .cls-1 {
                            fill: currentColor;
                        }
                    </style>
                </defs>
                <title>subscriptions</title>
                <path class="cls-1" d="M115.47,65.19c-2.39,12.7-9.16,23.86-18.67,31.85c-9.57,8.04-21.89,12.88-35.33,12.88
        c-12.63,0-24.28-4.27-33.57-11.45C18.4,91.14,11.38,80.77,8.27,68.81l6.86-1.78c2.7,10.41,8.82,19.44,17.09,25.83
        c8.08,6.24,18.22,9.95,29.24,9.95c11.73,0,22.47-4.21,30.78-11.19c7.95-6.68,13.7-15.91,15.98-26.44h-7.33l10.99-13.39
        l10.99,13.39H115.47ZM61.29,69.07V56.52c-4.42-1.12-7.65-2.81-9.7-5.07c-2.06-2.27-3.1-5.02-3.1-8.26
        c0-3.28,1.17-6.04,3.5-8.26c2.33-2.23,5.43-3.51,9.3-3.85v-2.95h4.94v2.95c3.62,0.38,6.49,1.47,8.64,3.26
        c2.13,1.79,3.5,4.19,4.09,7.19l-8.63,0.98c-0.53-2.36-1.9-3.96-4.1-4.8v11.71c5.46,1.29,9.18,2.98,11.15,5.04
        c1.98,2.07,2.97,4.72,2.97,7.96c0,3.62-1.24,6.66-3.73,9.14c-2.49,2.48-5.95,4.02-10.39,4.63v5.6h-4.94v-5.53
        c-3.9-0.42-7.06-1.69-9.51-3.83c-2.45-2.14-4-5.17-4.68-9.08l8.83-0.92c0.36,1.6,1.04,2.97,2.04,4.13
        C58.97,67.72,60.07,68.55,61.29,69.07ZM61.29,37.6c-1.33,0.42-2.38,1.11-3.15,2.07c-0.78,0.96-1.16,2.02-1.16,3.18
        c0,1.06,0.35,2.04,1.06,2.95c0.71,0.9,1.8,1.64,3.26,2.19V37.6ZM66.23,69.57c1.7-0.33,3.1-1.05,4.16-2.15
        C71.47,66.31,72,65.01,72,63.5c0-1.33-0.45-2.49-1.36-3.45c-0.89-0.97-2.36-1.71-4.42-2.23V69.57ZM7.46,44.74
        C9.83,32.15,16.5,21.08,25.87,13.1C35.47,4.93,47.9,0,61.46,0c11.93,0,22.97,3.8,31.98,10.26c9.25,6.63,16.35,16.06,20.08,27.06
        l-3.36,1.14l-3.36,1.14c-0.09-0.28-0.19-0.56-0.29-0.83c-3.31-9.21-9.38-17.11-17.2-22.72c-7.84-5.62-17.45-8.93-27.84-8.93
        c-11.84,0-22.67,4.28-31.01,11.38c-7.84,6.67-13.49,15.82-15.76,26.24h7.29L10.99,58.13L0,44.74H7.46Z"/>
            </svg>

            <span>Subscriptions</span>
        </a>
    </li>

    @if (isActive)
    {
        <li class="nav-item nav-item-sub">
            <a permission="@Policies.CanModifyServerSettings" 
               asp-controller="Product" asp-action="Index" asp-route-storeId="@storeId" 
               class="nav-link @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey, null, "Products")">Products</a>
        </li>
        <li class="nav-item nav-item-sub">
            <a permission="@Policies.CanModifyServerSettings" 
               asp-controller="Customer" asp-action="Index" asp-route-storeId="@storeId"
               class="nav-link @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey, null, "Customers")">Customers</a>
        </li>
    }
}
